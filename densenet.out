Available CPUs:  28
Available GPUs:  4
Train_Data:  4904
Test_Data:  936
cuda

7,610,498 total parameters.
656,642 training parameters.


******************* Training the model with 1 GPU *******************


Training
Device cuda:0..Epoch 1/3.. Step 5.. Train loss: 0.907.. Test loss: 0.564.. Test accuracy: 0.780
Device cuda:0..Epoch 1/3.. Step 10.. Train loss: 0.631.. Test loss: 0.554.. Test accuracy: 0.780
Device cuda:0..Epoch 1/3.. Step 15.. Train loss: 0.552.. Test loss: 0.469.. Test accuracy: 0.780
Device cuda:0..Epoch 1/3.. Step 20.. Train loss: 0.588.. Test loss: 0.668.. Test accuracy: 0.546
Device cuda:0..Epoch 1/3.. Step 25.. Train loss: 0.527.. Test loss: 0.396.. Test accuracy: 0.780
Device cuda:0..Epoch 1/3.. Step 30.. Train loss: 0.563.. Test loss: 0.639.. Test accuracy: 0.591
Device cuda:0..Epoch 1/3.. Step 35.. Train loss: 0.463.. Test loss: 0.346.. Test accuracy: 0.894
Device cuda:0..Epoch 1/3.. Step 40.. Train loss: 0.388.. Test loss: 0.555.. Test accuracy: 0.730
Device cuda:0..Epoch 1/3.. Step 45.. Train loss: 0.406.. Test loss: 0.239.. Test accuracy: 0.900
Device cuda:0..Epoch 1/3.. Step 50.. Train loss: 0.326.. Test loss: 0.844.. Test accuracy: 0.586
Device cuda:0..Epoch 1/3.. Step 55.. Train loss: 0.466.. Test loss: 0.303.. Test accuracy: 0.842
Device cuda:0..Epoch 1/3.. Step 60.. Train loss: 0.521.. Test loss: 0.425.. Test accuracy: 0.800
Device cuda:0..Epoch 1/3.. Step 65.. Train loss: 0.426.. Test loss: 0.412.. Test accuracy: 0.834
Device cuda:0..Epoch 1/3.. Step 70.. Train loss: 0.342.. Test loss: 0.258.. Test accuracy: 0.902
Device cuda:0..Epoch 1/3.. Step 75.. Train loss: 0.319.. Test loss: 0.416.. Test accuracy: 0.809
Device cuda:0..Epoch 1/3.. Step 80.. Train loss: 0.383.. Test loss: 0.409.. Test accuracy: 0.823
Device cuda:0..Epoch 1/3.. Step 85.. Train loss: 0.290.. Test loss: 0.321.. Test accuracy: 0.853
Device cuda:0..Epoch 1/3.. Step 90.. Train loss: 0.250.. Test loss: 0.275.. Test accuracy: 0.881
Device cuda:0..Epoch 1/3.. Step 95.. Train loss: 0.297.. Test loss: 0.370.. Test accuracy: 0.836
Device cuda:0..Epoch 1/3.. Step 100.. Train loss: 0.299.. Test loss: 0.285.. Test accuracy: 0.878
Device cuda:0..Epoch 1/3.. Step 105.. Train loss: 0.263.. Test loss: 0.346.. Test accuracy: 0.847
Device cuda:0..Epoch 1/3.. Step 110.. Train loss: 0.262.. Test loss: 0.247.. Test accuracy: 0.898
Device cuda:0..Epoch 1/3.. Step 115.. Train loss: 0.307.. Test loss: 0.383.. Test accuracy: 0.832
Device cuda:0..Epoch 1/3.. Step 120.. Train loss: 0.285.. Test loss: 0.352.. Test accuracy: 0.841
Device cuda:0..Epoch 1/3.. Step 125.. Train loss: 0.284.. Test loss: 0.272.. Test accuracy: 0.878
Device cuda:0..Epoch 1/3.. Step 130.. Train loss: 0.415.. Test loss: 0.269.. Test accuracy: 0.877
Device cuda:0..Epoch 1/3.. Step 135.. Train loss: 0.365.. Test loss: 0.371.. Test accuracy: 0.828
Device cuda:0..Epoch 1/3.. Step 140.. Train loss: 0.337.. Test loss: 0.226.. Test accuracy: 0.915
Device cuda:0..Epoch 1/3.. Step 145.. Train loss: 0.306.. Test loss: 0.420.. Test accuracy: 0.805
Device cuda:0..Epoch 1/3.. Step 150.. Train loss: 0.277.. Test loss: 0.216.. Test accuracy: 0.911
Device cuda:0..Epoch 2/3.. Step 155.. Train loss: 0.383.. Test loss: 0.462.. Test accuracy: 0.770
Device cuda:0..Epoch 2/3.. Step 160.. Train loss: 0.353.. Test loss: 0.229.. Test accuracy: 0.915
Device cuda:0..Epoch 2/3.. Step 165.. Train loss: 0.292.. Test loss: 0.230.. Test accuracy: 0.914
Device cuda:0..Epoch 2/3.. Step 170.. Train loss: 0.356.. Test loss: 0.401.. Test accuracy: 0.793
Device cuda:0..Epoch 2/3.. Step 175.. Train loss: 0.282.. Test loss: 0.225.. Test accuracy: 0.904
Device cuda:0..Epoch 2/3.. Step 180.. Train loss: 0.293.. Test loss: 0.264.. Test accuracy: 0.876
Device cuda:0..Epoch 2/3.. Step 185.. Train loss: 0.277.. Test loss: 0.257.. Test accuracy: 0.884
Device cuda:0..Epoch 2/3.. Step 190.. Train loss: 0.294.. Test loss: 0.365.. Test accuracy: 0.823
Device cuda:0..Epoch 2/3.. Step 195.. Train loss: 0.266.. Test loss: 0.224.. Test accuracy: 0.906
Device cuda:0..Epoch 2/3.. Step 200.. Train loss: 0.237.. Test loss: 0.375.. Test accuracy: 0.819
Device cuda:0..Epoch 2/3.. Step 205.. Train loss: 0.337.. Test loss: 0.359.. Test accuracy: 0.828
Device cuda:0..Epoch 2/3.. Step 210.. Train loss: 0.314.. Test loss: 0.373.. Test accuracy: 0.812
Device cuda:0..Epoch 2/3.. Step 215.. Train loss: 0.288.. Test loss: 0.304.. Test accuracy: 0.863
Device cuda:0..Epoch 2/3.. Step 220.. Train loss: 0.220.. Test loss: 0.252.. Test accuracy: 0.896
Device cuda:0..Epoch 2/3.. Step 225.. Train loss: 0.254.. Test loss: 0.412.. Test accuracy: 0.816
Device cuda:0..Epoch 2/3.. Step 230.. Train loss: 0.294.. Test loss: 0.248.. Test accuracy: 0.897
Device cuda:0..Epoch 2/3.. Step 235.. Train loss: 0.416.. Test loss: 0.329.. Test accuracy: 0.843
Device cuda:0..Epoch 2/3.. Step 240.. Train loss: 0.389.. Test loss: 0.298.. Test accuracy: 0.868
Device cuda:0..Epoch 2/3.. Step 245.. Train loss: 0.298.. Test loss: 0.258.. Test accuracy: 0.887
Device cuda:0..Epoch 2/3.. Step 250.. Train loss: 0.245.. Test loss: 0.283.. Test accuracy: 0.872
Device cuda:0..Epoch 2/3.. Step 255.. Train loss: 0.297.. Test loss: 0.280.. Test accuracy: 0.874
Device cuda:0..Epoch 2/3.. Step 260.. Train loss: 0.230.. Test loss: 0.397.. Test accuracy: 0.828
Device cuda:0..Epoch 2/3.. Step 265.. Train loss: 0.273.. Test loss: 0.265.. Test accuracy: 0.889
Device cuda:0..Epoch 2/3.. Step 270.. Train loss: 0.280.. Test loss: 0.276.. Test accuracy: 0.874
Device cuda:0..Epoch 2/3.. Step 275.. Train loss: 0.350.. Test loss: 0.221.. Test accuracy: 0.910
Device cuda:0..Epoch 2/3.. Step 280.. Train loss: 0.464.. Test loss: 0.304.. Test accuracy: 0.881
Device cuda:0..Epoch 2/3.. Step 285.. Train loss: 0.308.. Test loss: 0.298.. Test accuracy: 0.875
Device cuda:0..Epoch 2/3.. Step 290.. Train loss: 0.310.. Test loss: 0.233.. Test accuracy: 0.901
Device cuda:0..Epoch 2/3.. Step 295.. Train loss: 0.331.. Test loss: 0.410.. Test accuracy: 0.815
Device cuda:0..Epoch 2/3.. Step 300.. Train loss: 0.189.. Test loss: 0.269.. Test accuracy: 0.890
Device cuda:0..Epoch 2/3.. Step 305.. Train loss: 0.295.. Test loss: 0.281.. Test accuracy: 0.890
Device cuda:0..Epoch 3/3.. Step 310.. Train loss: 0.158.. Test loss: 0.285.. Test accuracy: 0.887
Device cuda:0..Epoch 3/3.. Step 315.. Train loss: 0.205.. Test loss: 0.263.. Test accuracy: 0.897
Device cuda:0..Epoch 3/3.. Step 320.. Train loss: 0.295.. Test loss: 0.330.. Test accuracy: 0.871
Device cuda:0..Epoch 3/3.. Step 325.. Train loss: 0.186.. Test loss: 0.248.. Test accuracy: 0.897
Device cuda:0..Epoch 3/3.. Step 330.. Train loss: 0.364.. Test loss: 0.293.. Test accuracy: 0.865
Device cuda:0..Epoch 3/3.. Step 335.. Train loss: 0.274.. Test loss: 0.245.. Test accuracy: 0.899
Device cuda:0..Epoch 3/3.. Step 340.. Train loss: 0.325.. Test loss: 0.276.. Test accuracy: 0.874
Device cuda:0..Epoch 3/3.. Step 345.. Train loss: 0.244.. Test loss: 0.216.. Test accuracy: 0.916
Device cuda:0..Epoch 3/3.. Step 350.. Train loss: 0.290.. Test loss: 0.388.. Test accuracy: 0.844
Device cuda:0..Epoch 3/3.. Step 355.. Train loss: 0.237.. Test loss: 0.267.. Test accuracy: 0.889
Device cuda:0..Epoch 3/3.. Step 360.. Train loss: 0.340.. Test loss: 0.268.. Test accuracy: 0.880
Device cuda:0..Epoch 3/3.. Step 365.. Train loss: 0.237.. Test loss: 0.295.. Test accuracy: 0.874
Device cuda:0..Epoch 3/3.. Step 370.. Train loss: 0.293.. Test loss: 0.266.. Test accuracy: 0.891
Device cuda:0..Epoch 3/3.. Step 375.. Train loss: 0.261.. Test loss: 0.247.. Test accuracy: 0.898
Device cuda:0..Epoch 3/3.. Step 380.. Train loss: 0.215.. Test loss: 0.272.. Test accuracy: 0.875
Device cuda:0..Epoch 3/3.. Step 385.. Train loss: 0.231.. Test loss: 0.336.. Test accuracy: 0.856
Device cuda:0..Epoch 3/3.. Step 390.. Train loss: 0.307.. Test loss: 0.293.. Test accuracy: 0.872
Device cuda:0..Epoch 3/3.. Step 395.. Train loss: 0.432.. Test loss: 0.357.. Test accuracy: 0.835
Device cuda:0..Epoch 3/3.. Step 400.. Train loss: 0.362.. Test loss: 0.238.. Test accuracy: 0.912
Device cuda:0..Epoch 3/3.. Step 405.. Train loss: 0.293.. Test loss: 0.241.. Test accuracy: 0.907
Device cuda:0..Epoch 3/3.. Step 410.. Train loss: 0.293.. Test loss: 0.303.. Test accuracy: 0.869
Device cuda:0..Epoch 3/3.. Step 415.. Train loss: 0.289.. Test loss: 0.361.. Test accuracy: 0.843
Device cuda:0..Epoch 3/3.. Step 420.. Train loss: 0.356.. Test loss: 0.234.. Test accuracy: 0.898
Device cuda:0..Epoch 3/3.. Step 425.. Train loss: 0.248.. Test loss: 0.276.. Test accuracy: 0.879
Device cuda:0..Epoch 3/3.. Step 430.. Train loss: 0.243.. Test loss: 0.216.. Test accuracy: 0.906
Device cuda:0..Epoch 3/3.. Step 435.. Train loss: 0.286.. Test loss: 0.335.. Test accuracy: 0.842
Device cuda:0..Epoch 3/3.. Step 440.. Train loss: 0.294.. Test loss: 0.220.. Test accuracy: 0.902
Device cuda:0..Epoch 3/3.. Step 445.. Train loss: 0.334.. Test loss: 0.271.. Test accuracy: 0.881
Device cuda:0..Epoch 3/3.. Step 450.. Train loss: 0.291.. Test loss: 0.335.. Test accuracy: 0.860
Device cuda:0..Epoch 3/3.. Step 455.. Train loss: 0.208.. Test loss: 0.211.. Test accuracy: 0.909
Device cuda:0..Epoch 3/3.. Step 460.. Train loss: 0.276.. Test loss: 0.294.. Test accuracy: 0.871
Training time  with 1 GPU 2799.36473941803


******************* Training the model with 2 GPUs *******************


Train_Data:  4904
Test_Data:  936
cuda
Inside Multi-GPU
Training
Device cuda..Epoch 1/3.. Step 5.. Train loss: 0.847.. Test loss: 0.538.. Test accuracy: 0.780
Device cuda..Epoch 1/3.. Step 10.. Train loss: 0.577.. Test loss: 0.515.. Test accuracy: 0.780
Device cuda..Epoch 1/3.. Step 15.. Train loss: 0.520.. Test loss: 0.452.. Test accuracy: 0.780
Device cuda..Epoch 1/3.. Step 20.. Train loss: 0.434.. Test loss: 0.353.. Test accuracy: 0.907
Device cuda..Epoch 1/3.. Step 25.. Train loss: 0.414.. Test loss: 0.252.. Test accuracy: 0.900
Device cuda..Epoch 1/3.. Step 30.. Train loss: 0.417.. Test loss: 0.309.. Test accuracy: 0.882
Device cuda..Epoch 1/3.. Step 35.. Train loss: 0.318.. Test loss: 0.577.. Test accuracy: 0.695
Device cuda..Epoch 1/3.. Step 40.. Train loss: 0.380.. Test loss: 0.269.. Test accuracy: 0.887
Device cuda..Epoch 1/3.. Step 45.. Train loss: 0.358.. Test loss: 0.271.. Test accuracy: 0.885
Device cuda..Epoch 1/3.. Step 50.. Train loss: 0.300.. Test loss: 0.282.. Test accuracy: 0.872
Device cuda..Epoch 1/3.. Step 55.. Train loss: 0.300.. Test loss: 0.267.. Test accuracy: 0.882
Device cuda..Epoch 1/3.. Step 60.. Train loss: 0.378.. Test loss: 0.598.. Test accuracy: 0.710
Device cuda..Epoch 1/3.. Step 65.. Train loss: 0.369.. Test loss: 0.248.. Test accuracy: 0.896
Device cuda..Epoch 1/3.. Step 70.. Train loss: 0.392.. Test loss: 0.360.. Test accuracy: 0.846
Device cuda..Epoch 1/3.. Step 75.. Train loss: 0.377.. Test loss: 0.265.. Test accuracy: 0.888
Device cuda..Epoch 2/3.. Step 80.. Train loss: 0.251.. Test loss: 0.361.. Test accuracy: 0.839
Device cuda..Epoch 2/3.. Step 85.. Train loss: 0.353.. Test loss: 0.238.. Test accuracy: 0.896
Device cuda..Epoch 2/3.. Step 90.. Train loss: 0.344.. Test loss: 0.379.. Test accuracy: 0.828
Device cuda..Epoch 2/3.. Step 95.. Train loss: 0.299.. Test loss: 0.224.. Test accuracy: 0.914
Device cuda..Epoch 2/3.. Step 100.. Train loss: 0.361.. Test loss: 0.453.. Test accuracy: 0.782
Device cuda..Epoch 2/3.. Step 105.. Train loss: 0.349.. Test loss: 0.233.. Test accuracy: 0.904
Device cuda..Epoch 2/3.. Step 110.. Train loss: 0.259.. Test loss: 0.263.. Test accuracy: 0.882
Device cuda..Epoch 2/3.. Step 115.. Train loss: 0.303.. Test loss: 0.304.. Test accuracy: 0.860
Device cuda..Epoch 2/3.. Step 120.. Train loss: 0.369.. Test loss: 0.431.. Test accuracy: 0.796
Device cuda..Epoch 2/3.. Step 125.. Train loss: 0.331.. Test loss: 0.220.. Test accuracy: 0.919
Device cuda..Epoch 2/3.. Step 130.. Train loss: 0.322.. Test loss: 0.235.. Test accuracy: 0.913
Device cuda..Epoch 2/3.. Step 135.. Train loss: 0.295.. Test loss: 0.453.. Test accuracy: 0.776
Device cuda..Epoch 2/3.. Step 140.. Train loss: 0.303.. Test loss: 0.250.. Test accuracy: 0.889
Device cuda..Epoch 2/3.. Step 145.. Train loss: 0.261.. Test loss: 0.298.. Test accuracy: 0.864
Device cuda..Epoch 2/3.. Step 150.. Train loss: 0.279.. Test loss: 0.267.. Test accuracy: 0.884
Device cuda..Epoch 3/3.. Step 155.. Train loss: 0.275.. Test loss: 0.280.. Test accuracy: 0.864
Device cuda..Epoch 3/3.. Step 160.. Train loss: 0.256.. Test loss: 0.234.. Test accuracy: 0.893
Device cuda..Epoch 3/3.. Step 165.. Train loss: 0.280.. Test loss: 0.218.. Test accuracy: 0.899
Device cuda..Epoch 3/3.. Step 170.. Train loss: 0.220.. Test loss: 0.280.. Test accuracy: 0.875
Device cuda..Epoch 3/3.. Step 175.. Train loss: 0.252.. Test loss: 0.424.. Test accuracy: 0.826
Device cuda..Epoch 3/3.. Step 180.. Train loss: 0.299.. Test loss: 0.203.. Test accuracy: 0.913
Device cuda..Epoch 3/3.. Step 185.. Train loss: 0.249.. Test loss: 0.334.. Test accuracy: 0.850
Device cuda..Epoch 3/3.. Step 190.. Train loss: 0.298.. Test loss: 0.201.. Test accuracy: 0.912
Device cuda..Epoch 3/3.. Step 195.. Train loss: 0.317.. Test loss: 0.283.. Test accuracy: 0.870
Device cuda..Epoch 3/3.. Step 200.. Train loss: 0.295.. Test loss: 0.223.. Test accuracy: 0.903
Device cuda..Epoch 3/3.. Step 205.. Train loss: 0.319.. Test loss: 0.236.. Test accuracy: 0.898
Device cuda..Epoch 3/3.. Step 210.. Train loss: 0.281.. Test loss: 0.418.. Test accuracy: 0.828
Device cuda..Epoch 3/3.. Step 215.. Train loss: 0.311.. Test loss: 0.210.. Test accuracy: 0.912
Device cuda..Epoch 3/3.. Step 220.. Train loss: 0.264.. Test loss: 0.365.. Test accuracy: 0.848
Device cuda..Epoch 3/3.. Step 225.. Train loss: 0.274.. Test loss: 0.290.. Test accuracy: 0.871
Device cuda..Epoch 3/3.. Step 230.. Train loss: 0.259.. Test loss: 0.229.. Test accuracy: 0.902
Training time 1690.3196268081665


******************* Training the model with 4 GPUs *******************


Train_Data:  4904
Test_Data:  936
cuda
Inside Multi-GPU
Training
Device cuda..Epoch 1/3.. Step 5.. Train loss: 0.919.. Test loss: 0.622.. Test accuracy: 0.794
Device cuda..Epoch 1/3.. Step 10.. Train loss: 0.577.. Test loss: 0.515.. Test accuracy: 0.794
Device cuda..Epoch 1/3.. Step 15.. Train loss: 0.556.. Test loss: 0.504.. Test accuracy: 0.794
Device cuda..Epoch 1/3.. Step 20.. Train loss: 0.519.. Test loss: 0.441.. Test accuracy: 0.794
Device cuda..Epoch 1/3.. Step 25.. Train loss: 0.454.. Test loss: 0.389.. Test accuracy: 0.883
Device cuda..Epoch 1/3.. Step 30.. Train loss: 0.410.. Test loss: 0.254.. Test accuracy: 0.906
Device cuda..Epoch 1/3.. Step 35.. Train loss: 0.405.. Test loss: 0.320.. Test accuracy: 0.865
Device cuda..Epoch 2/3.. Step 40.. Train loss: 0.346.. Test loss: 0.509.. Test accuracy: 0.757
Device cuda..Epoch 2/3.. Step 45.. Train loss: 0.347.. Test loss: 0.237.. Test accuracy: 0.904
Device cuda..Epoch 2/3.. Step 50.. Train loss: 0.315.. Test loss: 0.405.. Test accuracy: 0.819
Device cuda..Epoch 2/3.. Step 55.. Train loss: 0.289.. Test loss: 0.292.. Test accuracy: 0.875
Device cuda..Epoch 2/3.. Step 60.. Train loss: 0.302.. Test loss: 0.320.. Test accuracy: 0.854
Device cuda..Epoch 2/3.. Step 65.. Train loss: 0.323.. Test loss: 0.340.. Test accuracy: 0.844
Device cuda..Epoch 2/3.. Step 70.. Train loss: 0.304.. Test loss: 0.226.. Test accuracy: 0.908
Device cuda..Epoch 2/3.. Step 75.. Train loss: 0.274.. Test loss: 0.333.. Test accuracy: 0.856
Device cuda..Epoch 3/3.. Step 80.. Train loss: 0.243.. Test loss: 0.338.. Test accuracy: 0.848
Device cuda..Epoch 3/3.. Step 85.. Train loss: 0.299.. Test loss: 0.228.. Test accuracy: 0.901
Device cuda..Epoch 3/3.. Step 90.. Train loss: 0.272.. Test loss: 0.266.. Test accuracy: 0.874
Device cuda..Epoch 3/3.. Step 95.. Train loss: 0.263.. Test loss: 0.365.. Test accuracy: 0.843
Device cuda..Epoch 3/3.. Step 100.. Train loss: 0.295.. Test loss: 0.264.. Test accuracy: 0.881
Device cuda..Epoch 3/3.. Step 105.. Train loss: 0.287.. Test loss: 0.280.. Test accuracy: 0.871
Device cuda..Epoch 3/3.. Step 110.. Train loss: 0.259.. Test loss: 0.312.. Test accuracy: 0.854
Device cuda..Epoch 3/3.. Step 115.. Train loss: 0.240.. Test loss: 0.243.. Test accuracy: 0.894
Training time with 1 GPU 2799.36473941803
Training time with 2 GPUs1690.3196268081665
Training time with 4 GPUs1085.3724179267883
