Number of available CPUs:  56
Number of available GPUs:  4
Train_Data:  4904
Test_Data:  936
cuda

136,359,234 total parameters.
2,098,690 training parameters.


******************* Training the model with 1 GPU *******************


Device cuda:0..Epoch 1/3.. Step 5.. Train loss: 1.090.. Test loss: 0.566.. Test accuracy: 0.702
Device cuda:0..Epoch 1/3.. Step 10.. Train loss: 0.556.. Test loss: 0.454.. Test accuracy: 0.801
Device cuda:0..Epoch 1/3.. Step 15.. Train loss: 0.580.. Test loss: 0.627.. Test accuracy: 0.653
Device cuda:0..Epoch 1/3.. Step 20.. Train loss: 0.581.. Test loss: 0.378.. Test accuracy: 0.865
Device cuda:0..Epoch 1/3.. Step 25.. Train loss: 0.531.. Test loss: 0.386.. Test accuracy: 0.849
Device cuda:0..Epoch 1/3.. Step 30.. Train loss: 0.495.. Test loss: 0.483.. Test accuracy: 0.775
Device cuda:0..Epoch 1/3.. Step 35.. Train loss: 0.424.. Test loss: 0.339.. Test accuracy: 0.872
Device cuda:0..Epoch 1/3.. Step 40.. Train loss: 0.486.. Test loss: 0.441.. Test accuracy: 0.810
Device cuda:0..Epoch 1/3.. Step 45.. Train loss: 0.443.. Test loss: 0.603.. Test accuracy: 0.691
Device cuda:0..Epoch 1/3.. Step 50.. Train loss: 0.320.. Test loss: 0.340.. Test accuracy: 0.860
Device cuda:0..Epoch 1/3.. Step 55.. Train loss: 0.275.. Test loss: 0.421.. Test accuracy: 0.808
Device cuda:0..Epoch 1/3.. Step 60.. Train loss: 0.544.. Test loss: 0.441.. Test accuracy: 0.798
Device cuda:0..Epoch 1/3.. Step 65.. Train loss: 0.484.. Test loss: 0.477.. Test accuracy: 0.785
Device cuda:0..Epoch 1/3.. Step 70.. Train loss: 0.414.. Test loss: 0.421.. Test accuracy: 0.826
Device cuda:0..Epoch 1/3.. Step 75.. Train loss: 0.402.. Test loss: 0.417.. Test accuracy: 0.817
Device cuda:0..Epoch 1/3.. Step 80.. Train loss: 0.386.. Test loss: 0.428.. Test accuracy: 0.797
Device cuda:0..Epoch 1/3.. Step 85.. Train loss: 0.417.. Test loss: 0.407.. Test accuracy: 0.810
Device cuda:0..Epoch 1/3.. Step 90.. Train loss: 0.558.. Test loss: 0.398.. Test accuracy: 0.830
Device cuda:0..Epoch 1/3.. Step 95.. Train loss: 0.452.. Test loss: 0.511.. Test accuracy: 0.751
Device cuda:0..Epoch 1/3.. Step 100.. Train loss: 0.378.. Test loss: 0.389.. Test accuracy: 0.841
Device cuda:0..Epoch 1/3.. Step 105.. Train loss: 0.473.. Test loss: 0.477.. Test accuracy: 0.760
Device cuda:0..Epoch 1/3.. Step 110.. Train loss: 0.403.. Test loss: 0.425.. Test accuracy: 0.789
Device cuda:0..Epoch 1/3.. Step 115.. Train loss: 0.396.. Test loss: 0.294.. Test accuracy: 0.901
Device cuda:0..Epoch 1/3.. Step 120.. Train loss: 0.483.. Test loss: 0.577.. Test accuracy: 0.673
Device cuda:0..Epoch 1/3.. Step 125.. Train loss: 0.391.. Test loss: 0.359.. Test accuracy: 0.839
Device cuda:0..Epoch 1/3.. Step 130.. Train loss: 0.372.. Test loss: 0.375.. Test accuracy: 0.823
Device cuda:0..Epoch 1/3.. Step 135.. Train loss: 0.385.. Test loss: 0.687.. Test accuracy: 0.652
Device cuda:0..Epoch 1/3.. Step 140.. Train loss: 0.405.. Test loss: 0.362.. Test accuracy: 0.840
Device cuda:0..Epoch 1/3.. Step 145.. Train loss: 0.400.. Test loss: 0.362.. Test accuracy: 0.834
Device cuda:0..Epoch 1/3.. Step 150.. Train loss: 0.356.. Test loss: 0.373.. Test accuracy: 0.829
Device cuda:0..Epoch 2/3.. Step 155.. Train loss: 0.482.. Test loss: 0.301.. Test accuracy: 0.896
Device cuda:0..Epoch 2/3.. Step 160.. Train loss: 0.410.. Test loss: 0.391.. Test accuracy: 0.838
Device cuda:0..Epoch 2/3.. Step 165.. Train loss: 0.389.. Test loss: 0.354.. Test accuracy: 0.858
Device cuda:0..Epoch 2/3.. Step 170.. Train loss: 0.400.. Test loss: 0.310.. Test accuracy: 0.880
Device cuda:0..Epoch 2/3.. Step 175.. Train loss: 0.250.. Test loss: 0.270.. Test accuracy: 0.892
Device cuda:0..Epoch 2/3.. Step 180.. Train loss: 0.420.. Test loss: 0.410.. Test accuracy: 0.805
Device cuda:0..Epoch 2/3.. Step 185.. Train loss: 0.465.. Test loss: 0.354.. Test accuracy: 0.864
Device cuda:0..Epoch 2/3.. Step 190.. Train loss: 0.362.. Test loss: 0.354.. Test accuracy: 0.865
Device cuda:0..Epoch 2/3.. Step 195.. Train loss: 0.331.. Test loss: 0.374.. Test accuracy: 0.838
Device cuda:0..Epoch 2/3.. Step 200.. Train loss: 0.356.. Test loss: 0.462.. Test accuracy: 0.777
Device cuda:0..Epoch 2/3.. Step 205.. Train loss: 0.348.. Test loss: 0.309.. Test accuracy: 0.865
Device cuda:0..Epoch 2/3.. Step 210.. Train loss: 0.470.. Test loss: 0.475.. Test accuracy: 0.781
Device cuda:0..Epoch 2/3.. Step 215.. Train loss: 0.382.. Test loss: 0.330.. Test accuracy: 0.856
Device cuda:0..Epoch 2/3.. Step 220.. Train loss: 0.295.. Test loss: 0.349.. Test accuracy: 0.838
Device cuda:0..Epoch 2/3.. Step 225.. Train loss: 0.339.. Test loss: 0.315.. Test accuracy: 0.852
Device cuda:0..Epoch 2/3.. Step 230.. Train loss: 0.406.. Test loss: 0.486.. Test accuracy: 0.760
Device cuda:0..Epoch 2/3.. Step 235.. Train loss: 0.444.. Test loss: 0.389.. Test accuracy: 0.819
Device cuda:0..Epoch 2/3.. Step 240.. Train loss: 0.423.. Test loss: 0.387.. Test accuracy: 0.821
Device cuda:0..Epoch 2/3.. Step 245.. Train loss: 0.475.. Test loss: 0.555.. Test accuracy: 0.705
Device cuda:0..Epoch 2/3.. Step 250.. Train loss: 0.315.. Test loss: 0.353.. Test accuracy: 0.848
Device cuda:0..Epoch 2/3.. Step 255.. Train loss: 0.435.. Test loss: 0.489.. Test accuracy: 0.745
Device cuda:0..Epoch 2/3.. Step 260.. Train loss: 0.354.. Test loss: 0.361.. Test accuracy: 0.847
Device cuda:0..Epoch 2/3.. Step 265.. Train loss: 0.381.. Test loss: 0.332.. Test accuracy: 0.856
Device cuda:0..Epoch 2/3.. Step 270.. Train loss: 0.382.. Test loss: 0.450.. Test accuracy: 0.779
Device cuda:0..Epoch 2/3.. Step 275.. Train loss: 0.434.. Test loss: 0.573.. Test accuracy: 0.693
Device cuda:0..Epoch 2/3.. Step 280.. Train loss: 0.427.. Test loss: 0.383.. Test accuracy: 0.818
Device cuda:0..Epoch 2/3.. Step 285.. Train loss: 0.285.. Test loss: 0.365.. Test accuracy: 0.823
Device cuda:0..Epoch 2/3.. Step 290.. Train loss: 0.368.. Test loss: 0.443.. Test accuracy: 0.781
Device cuda:0..Epoch 2/3.. Step 295.. Train loss: 0.411.. Test loss: 0.492.. Test accuracy: 0.748
Device cuda:0..Epoch 2/3.. Step 300.. Train loss: 0.394.. Test loss: 0.363.. Test accuracy: 0.834
Device cuda:0..Epoch 2/3.. Step 305.. Train loss: 0.360.. Test loss: 0.330.. Test accuracy: 0.859
Device cuda:0..Epoch 3/3.. Step 310.. Train loss: 0.277.. Test loss: 0.289.. Test accuracy: 0.882
Device cuda:0..Epoch 3/3.. Step 315.. Train loss: 0.364.. Test loss: 0.295.. Test accuracy: 0.874
Device cuda:0..Epoch 3/3.. Step 320.. Train loss: 0.378.. Test loss: 0.434.. Test accuracy: 0.797
Device cuda:0..Epoch 3/3.. Step 325.. Train loss: 0.405.. Test loss: 0.350.. Test accuracy: 0.851
Device cuda:0..Epoch 3/3.. Step 330.. Train loss: 0.354.. Test loss: 0.377.. Test accuracy: 0.831
Device cuda:0..Epoch 3/3.. Step 335.. Train loss: 0.459.. Test loss: 0.446.. Test accuracy: 0.782
Device cuda:0..Epoch 3/3.. Step 340.. Train loss: 0.432.. Test loss: 0.335.. Test accuracy: 0.887
Device cuda:0..Epoch 3/3.. Step 345.. Train loss: 0.347.. Test loss: 0.306.. Test accuracy: 0.899
Device cuda:0..Epoch 3/3.. Step 350.. Train loss: 0.400.. Test loss: 0.394.. Test accuracy: 0.827
Device cuda:0..Epoch 3/3.. Step 355.. Train loss: 0.380.. Test loss: 0.403.. Test accuracy: 0.812
Device cuda:0..Epoch 3/3.. Step 360.. Train loss: 0.376.. Test loss: 0.430.. Test accuracy: 0.798
Device cuda:0..Epoch 3/3.. Step 365.. Train loss: 0.303.. Test loss: 0.422.. Test accuracy: 0.803
Device cuda:0..Epoch 3/3.. Step 370.. Train loss: 0.460.. Test loss: 0.281.. Test accuracy: 0.890
Device cuda:0..Epoch 3/3.. Step 375.. Train loss: 0.417.. Test loss: 0.403.. Test accuracy: 0.827
Device cuda:0..Epoch 3/3.. Step 380.. Train loss: 0.352.. Test loss: 0.405.. Test accuracy: 0.826
Device cuda:0..Epoch 3/3.. Step 385.. Train loss: 0.400.. Test loss: 0.341.. Test accuracy: 0.846
Device cuda:0..Epoch 3/3.. Step 390.. Train loss: 0.450.. Test loss: 0.336.. Test accuracy: 0.859
Device cuda:0..Epoch 3/3.. Step 395.. Train loss: 0.454.. Test loss: 0.385.. Test accuracy: 0.843
Device cuda:0..Epoch 3/3.. Step 400.. Train loss: 0.415.. Test loss: 0.428.. Test accuracy: 0.796
Device cuda:0..Epoch 3/3.. Step 405.. Train loss: 0.354.. Test loss: 0.324.. Test accuracy: 0.870
Device cuda:0..Epoch 3/3.. Step 410.. Train loss: 0.420.. Test loss: 0.433.. Test accuracy: 0.790
Device cuda:0..Epoch 3/3.. Step 415.. Train loss: 0.459.. Test loss: 0.422.. Test accuracy: 0.794
Device cuda:0..Epoch 3/3.. Step 420.. Train loss: 0.353.. Test loss: 0.368.. Test accuracy: 0.849
Device cuda:0..Epoch 3/3.. Step 425.. Train loss: 0.401.. Test loss: 0.397.. Test accuracy: 0.814
Device cuda:0..Epoch 3/3.. Step 430.. Train loss: 0.334.. Test loss: 0.369.. Test accuracy: 0.833
Device cuda:0..Epoch 3/3.. Step 435.. Train loss: 0.365.. Test loss: 0.377.. Test accuracy: 0.822
Device cuda:0..Epoch 3/3.. Step 440.. Train loss: 0.327.. Test loss: 0.348.. Test accuracy: 0.828
Device cuda:0..Epoch 3/3.. Step 445.. Train loss: 0.426.. Test loss: 0.360.. Test accuracy: 0.825
Device cuda:0..Epoch 3/3.. Step 450.. Train loss: 0.438.. Test loss: 0.484.. Test accuracy: 0.740
Device cuda:0..Epoch 3/3.. Step 455.. Train loss: 0.370.. Test loss: 0.445.. Test accuracy: 0.786
Device cuda:0..Epoch 3/3.. Step 460.. Train loss: 0.364.. Test loss: 0.284.. Test accuracy: 0.896
Training time  with 1 GPU 2575.2528278827667


******************* Training the model with 2 GPUs *******************


Train_Data:  4904
Test_Data:  936
cuda
Sequential(
  (0): Linear(in_features=25088, out_features=4096, bias=True)
  (1): ReLU(inplace=True)
  (2): Dropout(p=0.5, inplace=False)
  (3): Linear(in_features=4096, out_features=4096, bias=True)
  (4): ReLU(inplace=True)
  (5): Dropout(p=0.5, inplace=False)
  (6): Linear(in_features=4096, out_features=1000, bias=True)
)
Inside Multi-GPU 2
Device cuda..Epoch 1/3.. Step 5.. Train loss: 1.273.. Test loss: 0.840.. Test accuracy: 0.458
Device cuda..Epoch 1/3.. Step 10.. Train loss: 0.586.. Test loss: 0.490.. Test accuracy: 0.802
Device cuda..Epoch 1/3.. Step 15.. Train loss: 0.444.. Test loss: 0.683.. Test accuracy: 0.552
Device cuda..Epoch 1/3.. Step 20.. Train loss: 0.386.. Test loss: 0.429.. Test accuracy: 0.821
Device cuda..Epoch 1/3.. Step 25.. Train loss: 0.458.. Test loss: 0.611.. Test accuracy: 0.674
Device cuda..Epoch 1/3.. Step 30.. Train loss: 0.384.. Test loss: 0.406.. Test accuracy: 0.830
Device cuda..Epoch 1/3.. Step 35.. Train loss: 0.432.. Test loss: 0.514.. Test accuracy: 0.732
Device cuda..Epoch 1/3.. Step 40.. Train loss: 0.411.. Test loss: 0.383.. Test accuracy: 0.848
Device cuda..Epoch 1/3.. Step 45.. Train loss: 0.387.. Test loss: 0.586.. Test accuracy: 0.694
Device cuda..Epoch 1/3.. Step 50.. Train loss: 0.379.. Test loss: 0.320.. Test accuracy: 0.863
Device cuda..Epoch 1/3.. Step 55.. Train loss: 0.421.. Test loss: 0.649.. Test accuracy: 0.661
Device cuda..Epoch 1/3.. Step 60.. Train loss: 0.357.. Test loss: 0.400.. Test accuracy: 0.826
Device cuda..Epoch 1/3.. Step 65.. Train loss: 0.331.. Test loss: 0.374.. Test accuracy: 0.834
Device cuda..Epoch 1/3.. Step 70.. Train loss: 0.429.. Test loss: 0.536.. Test accuracy: 0.743
Device cuda..Epoch 1/3.. Step 75.. Train loss: 0.398.. Test loss: 0.353.. Test accuracy: 0.865
Device cuda..Epoch 2/3.. Step 80.. Train loss: 0.382.. Test loss: 0.415.. Test accuracy: 0.821
Device cuda..Epoch 2/3.. Step 85.. Train loss: 0.411.. Test loss: 0.338.. Test accuracy: 0.869
Device cuda..Epoch 2/3.. Step 90.. Train loss: 0.366.. Test loss: 0.392.. Test accuracy: 0.828
Device cuda..Epoch 2/3.. Step 95.. Train loss: 0.420.. Test loss: 0.470.. Test accuracy: 0.771
Device cuda..Epoch 2/3.. Step 100.. Train loss: 0.394.. Test loss: 0.337.. Test accuracy: 0.869
Device cuda..Epoch 2/3.. Step 105.. Train loss: 0.420.. Test loss: 0.390.. Test accuracy: 0.834
Device cuda..Epoch 2/3.. Step 110.. Train loss: 0.411.. Test loss: 0.388.. Test accuracy: 0.837
Device cuda..Epoch 2/3.. Step 115.. Train loss: 0.366.. Test loss: 0.302.. Test accuracy: 0.893
Device cuda..Epoch 2/3.. Step 120.. Train loss: 0.350.. Test loss: 0.466.. Test accuracy: 0.750
Device cuda..Epoch 2/3.. Step 125.. Train loss: 0.373.. Test loss: 0.374.. Test accuracy: 0.821
Device cuda..Epoch 2/3.. Step 130.. Train loss: 0.410.. Test loss: 0.325.. Test accuracy: 0.885
Device cuda..Epoch 2/3.. Step 135.. Train loss: 0.332.. Test loss: 0.470.. Test accuracy: 0.748
Device cuda..Epoch 2/3.. Step 140.. Train loss: 0.369.. Test loss: 0.312.. Test accuracy: 0.876
Device cuda..Epoch 2/3.. Step 145.. Train loss: 0.342.. Test loss: 0.404.. Test accuracy: 0.801
Device cuda..Epoch 2/3.. Step 150.. Train loss: 0.363.. Test loss: 0.337.. Test accuracy: 0.854
Device cuda..Epoch 3/3.. Step 155.. Train loss: 0.363.. Test loss: 0.394.. Test accuracy: 0.819
Device cuda..Epoch 3/3.. Step 160.. Train loss: 0.393.. Test loss: 0.383.. Test accuracy: 0.831
Device cuda..Epoch 3/3.. Step 165.. Train loss: 0.347.. Test loss: 0.327.. Test accuracy: 0.867
Device cuda..Epoch 3/3.. Step 170.. Train loss: 0.381.. Test loss: 0.383.. Test accuracy: 0.825
Device cuda..Epoch 3/3.. Step 175.. Train loss: 0.344.. Test loss: 0.410.. Test accuracy: 0.809
Device cuda..Epoch 3/3.. Step 180.. Train loss: 0.393.. Test loss: 0.258.. Test accuracy: 0.909
Device cuda..Epoch 3/3.. Step 185.. Train loss: 0.337.. Test loss: 0.310.. Test accuracy: 0.872
Device cuda..Epoch 3/3.. Step 190.. Train loss: 0.324.. Test loss: 0.291.. Test accuracy: 0.878
Device cuda..Epoch 3/3.. Step 195.. Train loss: 0.367.. Test loss: 0.331.. Test accuracy: 0.854
Device cuda..Epoch 3/3.. Step 200.. Train loss: 0.368.. Test loss: 0.299.. Test accuracy: 0.880
Device cuda..Epoch 3/3.. Step 205.. Train loss: 0.336.. Test loss: 0.305.. Test accuracy: 0.874
Device cuda..Epoch 3/3.. Step 210.. Train loss: 0.405.. Test loss: 0.380.. Test accuracy: 0.821
Device cuda..Epoch 3/3.. Step 215.. Train loss: 0.313.. Test loss: 0.301.. Test accuracy: 0.876
Device cuda..Epoch 3/3.. Step 220.. Train loss: 0.370.. Test loss: 0.373.. Test accuracy: 0.823
Device cuda..Epoch 3/3.. Step 225.. Train loss: 0.381.. Test loss: 0.300.. Test accuracy: 0.872
Device cuda..Epoch 3/3.. Step 230.. Train loss: 0.338.. Test loss: 0.323.. Test accuracy: 0.860
Training time 1545.1475002765656


******************* Training the model with 4 GPUs *******************


Train_Data:  4904
Test_Data:  936
cuda

Inside Multi-GPU 4

Device cuda..Epoch 1/3.. Step 5.. Train loss: 1.809.. Test loss: 0.819.. Test accuracy: 0.261
Device cuda..Epoch 1/3.. Step 10.. Train loss: 0.574.. Test loss: 0.421.. Test accuracy: 0.808
Device cuda..Epoch 1/3.. Step 15.. Train loss: 0.569.. Test loss: 0.632.. Test accuracy: 0.599
Device cuda..Epoch 1/3.. Step 20.. Train loss: 0.498.. Test loss: 0.454.. Test accuracy: 0.835
Device cuda..Epoch 1/3.. Step 25.. Train loss: 0.466.. Test loss: 0.482.. Test accuracy: 0.787
Device cuda..Epoch 1/3.. Step 30.. Train loss: 0.410.. Test loss: 0.458.. Test accuracy: 0.788
Device cuda..Epoch 1/3.. Step 35.. Train loss: 0.393.. Test loss: 0.432.. Test accuracy: 0.779
Device cuda..Epoch 2/3.. Step 40.. Train loss: 0.397.. Test loss: 0.446.. Test accuracy: 0.759
Device cuda..Epoch 2/3.. Step 45.. Train loss: 0.433.. Test loss: 0.416.. Test accuracy: 0.805
Device cuda..Epoch 2/3.. Step 50.. Train loss: 0.404.. Test loss: 0.429.. Test accuracy: 0.790
Device cuda..Epoch 2/3.. Step 55.. Train loss: 0.403.. Test loss: 0.357.. Test accuracy: 0.833
Device cuda..Epoch 2/3.. Step 60.. Train loss: 0.378.. Test loss: 0.436.. Test accuracy: 0.776
Device cuda..Epoch 2/3.. Step 65.. Train loss: 0.358.. Test loss: 0.288.. Test accuracy: 0.883
Device cuda..Epoch 2/3.. Step 70.. Train loss: 0.403.. Test loss: 0.435.. Test accuracy: 0.787
Device cuda..Epoch 2/3.. Step 75.. Train loss: 0.418.. Test loss: 0.369.. Test accuracy: 0.836
Device cuda..Epoch 3/3.. Step 80.. Train loss: 0.365.. Test loss: 0.270.. Test accuracy: 0.896
Device cuda..Epoch 3/3.. Step 85.. Train loss: 0.404.. Test loss: 0.366.. Test accuracy: 0.841
Device cuda..Epoch 3/3.. Step 90.. Train loss: 0.378.. Test loss: 0.358.. Test accuracy: 0.832
Device cuda..Epoch 3/3.. Step 95.. Train loss: 0.367.. Test loss: 0.363.. Test accuracy: 0.824
Device cuda..Epoch 3/3.. Step 100.. Train loss: 0.389.. Test loss: 0.436.. Test accuracy: 0.771
Device cuda..Epoch 3/3.. Step 105.. Train loss: 0.390.. Test loss: 0.344.. Test accuracy: 0.837
Device cuda..Epoch 3/3.. Step 110.. Train loss: 0.391.. Test loss: 0.355.. Test accuracy: 0.842
Device cuda..Epoch 3/3.. Step 115.. Train loss: 0.389.. Test loss: 0.325.. Test accuracy: 0.872

Training time with 1 GPU 2575.2528278827667
Training time with 2 GPUs1545.1475002765656
Training time with 4 GPUs1007.1175796985626
